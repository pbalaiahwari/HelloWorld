<project>
    <shortName>PredictGo</shortName>
    <fullName>Logi Predict</fullName>
    <version>1.1.70</version>
    <installerFilename>Logi-Info-${product_shortname}-Setup-${product_version}.${platform_exec_suffix}</installerFilename>
    <leftImage>supportfiles/LogiPredictLarge.png</leftImage>
    <logoImage>supportfiles/LogiPredictSmall.png</logoImage>
    <languageSelectionStyle>onlyEnglishNames</languageSelectionStyle>
    <componentList>
        <component>
            <name>default</name>
            <description>Default Component</description>
            <canBeEdited>1</canBeEdited>
            <selected>1</selected>
            <show>1</show>
            <folderList>
                <folder>
                    <description>Program Files</description>
                    <destination>${installdir}</destination>
                    <name>programfiles</name>
                    <platforms>all</platforms>
                    <shortcutList>
                        <shortcut>
                            <comment>Uninstall</comment>
                            <exec>${installdir}/${uninstallerName}</exec>
                            <icon></icon>
                            <name>Uninstall_${product_fullname}</name>
                            <path>${installdir}</path>
                            <platforms>all</platforms>
                            <runAsAdmin>0</runAsAdmin>
                            <runInTerminal>0</runInTerminal>
                            <windowsExec>${installdir}/${uninstallerName}.exe</windowsExec>
                            <windowsExecArgs></windowsExecArgs>
                            <windowsIcon></windowsIcon>
                            <windowsPath>${installdir}</windowsPath>
                        </shortcut>
                    </shortcutList>
                </folder>
                <folder>
                    <description>java</description>
                    <destination>${installdir}/</destination>
                    <name>java</name>
                    <platforms>linux-x64</platforms>
                    <actionList>
                        <changePermissions>
                            <abortOnError>0</abortOnError>
                            <files>${installdir}/java/jre1.8.0_102/*</files>
                            <permissions>0755</permissions>
                        </changePermissions>
                        <changePermissions>
                            <abortOnError>0</abortOnError>
                            <files>${installdir}/java/jre1.8.0_102/bin/*</files>
                            <permissions>0755</permissions>
                        </changePermissions>
                    </actionList>
                    <distributionFileList>
                        <distributionDirectory>
                            <origin>../../../dotnet/java</origin>
                        </distributionDirectory>
                    </distributionFileList>
                    <ruleList>
                        <isTrue>
                            <value>${bundle_java}</value>
                        </isTrue>
                    </ruleList>
                </folder>
                <folder>
                    <description>tomcat</description>
                    <destination>${installdir}/</destination>
                    <name>tomcat</name>
                    <platforms>linux-x64</platforms>
                    <actionList>
                        <changePermissions>
                            <files>${installdir}/apache-tomcat-8.5.24/*</files>
                            <permissions>0755</permissions>
                        </changePermissions>
                        <changePermissions>
                            <files>${installdir}/apache-tomcat-8.5.24/bin/*.sh</files>
                            <permissions>0755</permissions>
                        </changePermissions>
                    </actionList>
                    <distributionFileList>
                        <distributionDirectory>
                            <origin>../../../dotnet/apache-tomcat-8.5.24</origin>
                        </distributionDirectory>
                    </distributionFileList>
                    <ruleList>
                        <compareValues>
                            <logic>equals</logic>
                            <value1>${tomcat}</value1>
                            <value2>installtomcat</value2>
                        </compareValues>
                    </ruleList>
                </folder>
                <folder>
                    <description>Web</description>
                    <destination>${tomcatdir}/PredictGo</destination>
                    <name>Web</name>
                    <platforms>linux-x64</platforms>
                    <distributionFileList>
                        <distributionDirectory>
                            <origin>javaengine/Web/assemblies</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>javaengine/Web/rdTemplate</origin>
                            <onPackingFilterList>
                                <fileNameFilter>
                                    <logic>does_not_match</logic>
                                    <pattern>.resx</pattern>
                                    <patternType>regexp</patternType>
                                </fileNameFilter>
                            </onPackingFilterList>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>javaengine/Web/WEB-INF</origin>
                        </distributionDirectory>
                        <distributionFile>
                            <origin>javaengine/Web/Default.aspx</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>javaengine/Web/Global.asax</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>javaengine/Web/rdHelp.png</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>javaengine/Web/rdLogon.aspx</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>javaengine/Web/rdLogon.jsp</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>javaengine/Web/rdPage.aspx</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>javaengine/Web/rdPageAsync.aspx</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>javaengine/Web/rdProcess.aspx</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>javaengine/Web/rdProcessAsync.aspx</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>javaengine/Web/Web.config</origin>
                        </distributionFile>
                        <distributionDirectory>
                            <origin>Web/_Definitions</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>Web/_SupportFiles</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>supportfiles/goBookmarks</origin>
                        </distributionDirectory>
                    </distributionFileList>
                </folder>
                <folder>
                    <description>_Definitions</description>
                    <destination>${tomcatdir}/PredictGo/_Definitions</destination>
                    <name>_Definitions</name>
                    <platforms>linux-x64</platforms>
                    <distributionFileList>
                        <distributionFile>
                            <origin>supportfiles/ApplicationNotepad.xml</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>supportfiles/_Settings.lgx</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>supportfiles/fresh_Settings.lgx</origin>
                        </distributionFile>
                    </distributionFileList>
                </folder>
                <folder>
                    <description>rdDataCache</description>
                    <destination>${tomcatdir}/PredictGo/rdDataCache</destination>
                    <name>rdDataCache</name>
                    <platforms>linux-x64</platforms>
                </folder>
                <folder>
                    <description>rdDownload</description>
                    <destination>${tomcatdir}/PredictGo/rdDownload</destination>
                    <name>rdDownload</name>
                    <platforms>linux-x64</platforms>
                </folder>
                <folder>
                    <description>R</description>
                    <destination>${tomcatdir}/PredictGo/R</destination>
                    <name>R</name>
                    <platforms>linux-x64</platforms>
                    <distributionFileList>
                        <distributionDirectory>
                            <origin>Web/R/scripts</origin>
                        </distributionDirectory>
                        <distributionFile>
                            <origin>Web/R/Rsetting</origin>
                        </distributionFile>
                    </distributionFileList>
                </folder>
                <folder>
                    <description>rworkspace</description>
                    <destination>${tomcatdir}/PredictGo/R/workspace</destination>
                    <name>rworkspace</name>
                    <platforms>linux-x64</platforms>
                </folder>
            </folderList>
            <postInstallationActionList>
                <substitute>
                    <files>${installdir}/apache-tomcat-8.5.24/conf/server.xml</files>
                    <type>regexp</type>
                    <ruleList>
                        <compareValues>
                            <logic>equals</logic>
                            <value1>${tomcat}</value1>
                            <value2>installtomcat</value2>
                        </compareValues>
                    </ruleList>
                    <substitutionList>
                        <substitution>
                            <pattern>Connector port="8080" protocol="HTTP/1.1"</pattern>
                            <value>Connector port="${port}" protocol="HTTP/1.1"</value>
                        </substitution>
                    </substitutionList>
                </substitute>
                <substitute>
                    <abortOnError>0</abortOnError>
                    <files>${installdir}/apache-tomcat-8.5.24/bin/catalina.sh</files>
                    <type>regexp</type>
                    <ruleList>
                        <compareValues>
                            <logic>equals</logic>
                            <value1>${tomcat}</value1>
                            <value2>installtomcat</value2>
                        </compareValues>
                    </ruleList>
                    <substitutionList>
                        <substitution>
                            <pattern># export JAVA_HOME=@@java_home@@</pattern>
                            <value>export JAVA_HOME=${installdir}/java/jre1.8.0_102</value>
                            <ruleList>
                                <isTrue>
                                    <value>${bundle_java}</value>
                                </isTrue>
                            </ruleList>
                        </substitution>
                        <substitution>
                            <pattern># export JAVA_HOME=@@java_home@@</pattern>
                            <value>export JAVA_HOME=${java_home}</value>
                            <ruleList>
                                <isFalse>
                                    <value>${bundle_java}</value>
                                </isFalse>
                            </ruleList>
                        </substitution>
                        <substitution>
                            <pattern># export CATALINA_HOME=@@catalina_home@@</pattern>
                            <value>export CATALINA_HOME=${installdir}/apache-tomcat-8.5.24</value>
                        </substitution>

                        <!-- <substitution>
            <pattern># export JAVA_HOME=@@java_home@@</pattern>
            <value>export JAVA_HOME=${java_home}</value>
            <ruleList>
                <isFalse>
                    <value>${bundle_java}</value>
                </isFalse>
            </ruleList>
        </substitution> -->
                    </substitutionList>
                </substitute>
                <substitute>
                    <abortOnError>0</abortOnError>
                    <files>${tomcatdir}/PredictGo/_Definitions/_Settings.lgx</files>
                    <type>regexp</type>
                    <substitutionList>
                        <substitution>
                            <pattern>"http://localhost/PredictGo"</pattern>
                            <value>"http://localhost:${port}/PredictGo"</value>
                        </substitution>
                    </substitutionList>
                </substitute>
                <runProgram>
                    <abortOnError>0</abortOnError>
                    <customErrorMessage>Failed to start Tomcat please start manually.</customErrorMessage>
                    <program>${installdir}/apache-tomcat-8.5.24/bin/startup.sh</program>
                    <programArguments></programArguments>
                    <ruleList>
                        <compareValues>
                            <logic>equals</logic>
                            <value1>${tomcat}</value1>
                            <value2>installtomcat</value2>
                        </compareValues>
                    </ruleList>
                </runProgram>
            </postInstallationActionList>
            <postUninstallationActionList>
                <deleteFile>
                    <path>${installdir}/apache-tomcat-8.5.24</path>
                    <ruleList>
                        <fileExists>
                            <path>${installdir}/apache-tomcat-8.5.24</path>
                        </fileExists>
                    </ruleList>
                </deleteFile>
                <deleteFile>
                    <path>${installdir}/java</path>
                    <ruleList>
                        <fileExists>
                            <path>${installdir}/java</path>
                        </fileExists>
                    </ruleList>
                </deleteFile>
            </postUninstallationActionList>
            <preUninstallationActionList>
                <runProgram>
                    <abortOnError>0</abortOnError>
                    <program>${installdir}/apache-tomcat-8.5.24/bin/shutdown.sh</program>
                    <programArguments></programArguments>
                    <showMessageOnError>0</showMessageOnError>
                    <ruleList>
                        <fileExists>
                            <path>${installdir}/apache-tomcat-8.5.24/bin/shutdown.sh</path>
                        </fileExists>
                    </ruleList>
                </runProgram>
            </preUninstallationActionList>
            <startMenuShortcutList>
                <startMenuShortcut>
                    <comment>Uninstall ${product_fullname}</comment>
                    <name>Uninstall ${product_fullname}</name>
                    <runAsAdmin>0</runAsAdmin>
                    <runInTerminal>0</runInTerminal>
                    <windowsExec>${installdir}/${uninstallerName}.exe</windowsExec>
                    <windowsExecArgs></windowsExecArgs>
                    <windowsIcon></windowsIcon>
                    <windowsPath>${installdir}/</windowsPath>
                </startMenuShortcut>
            </startMenuShortcutList>
        </component>
        <component>
            <name>upgrade</name>
            <description>Upgrade Component</description>
            <canBeEdited>1</canBeEdited>
            <selected>0</selected>
            <show>0</show>
            <folderList>
                <folder>
                    <description>Program Files</description>
                    <destination>${installdir}</destination>
                    <name>programfiles</name>
                    <platforms>all</platforms>
                    <shortcutList>
                        <shortcut>
                            <comment>Uninstall</comment>
                            <exec>${installdir}/${uninstallerName}</exec>
                            <icon></icon>
                            <name>Uninstall_${product_fullname}</name>
                            <path>${installdir}</path>
                            <platforms>all</platforms>
                            <runAsAdmin>0</runAsAdmin>
                            <runInTerminal>0</runInTerminal>
                            <windowsExec>${installdir}/${uninstallerName}.exe</windowsExec>
                            <windowsExecArgs></windowsExecArgs>
                            <windowsIcon></windowsIcon>
                            <windowsPath>${installdir}</windowsPath>
                        </shortcut>
                    </shortcutList>
                </folder>
                <folder>
                    <description>Web</description>
                    <destination>${tomcatdir}/PredictGo</destination>
                    <name>Web</name>
                    <platforms>linux-x64</platforms>
                    <distributionFileList>
                        <distributionDirectory>
                            <origin>javaengine/Web/assemblies</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>javaengine/Web/rdTemplate</origin>
                            <onPackingFilterList>
                                <fileNameFilter>
                                    <logic>does_not_match</logic>
                                    <pattern>.resx</pattern>
                                    <patternType>regexp</patternType>
                                </fileNameFilter>
                            </onPackingFilterList>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>javaengine/Web/WEB-INF</origin>
                        </distributionDirectory>
                        <distributionFile>
                            <origin>javaengine/Web/Default.aspx</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>javaengine/Web/Global.asax</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>javaengine/Web/rdHelp.png</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>javaengine/Web/rdLogon.aspx</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>javaengine/Web/rdLogon.jsp</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>javaengine/Web/rdPage.aspx</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>javaengine/Web/rdPageAsync.aspx</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>javaengine/Web/rdProcess.aspx</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>javaengine/Web/rdProcessAsync.aspx</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>javaengine/Web/Web.config</origin>
                        </distributionFile>
                        <distributionDirectory>
                            <origin>Web/_Definitions</origin>
                            <onPackingFilterList>
                                <fileNameFilter>
                                    <logic>does_not_match</logic>
                                    <pattern>goCustomizations.*</pattern>
                                    <patternType>regexp</patternType>
                                </fileNameFilter>
                            </onPackingFilterList>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>Web/_SupportFiles</origin>
                            <onPackingFilterList>
                                <fileNameFilter>
                                    <logic>does_not_match</logic>
                                    <pattern>goCustomizations.*</pattern>
                                    <patternType>regexp</patternType>
                                </fileNameFilter>
                            </onPackingFilterList>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>supportfiles/goBookmarks</origin>
                        </distributionDirectory>
                    </distributionFileList>
                </folder>
                <folder>
                    <description>_Definitions</description>
                    <destination>${tomcatdir}/PredictGo/_Definitions</destination>
                    <name>_Definitions</name>
                    <platforms>linux-x64</platforms>
                    <distributionFileList>
                        <distributionFile>
                            <origin>supportfiles/ApplicationNotepad.xml</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>supportfiles/fresh_Settings.lgx</origin>
                        </distributionFile>
                    </distributionFileList>
                </folder>
                <folder>
                    <description>rdDataCache</description>
                    <destination>${tomcatdir}/PredictGo/rdDataCache</destination>
                    <name>rdDataCache</name>
                    <platforms>linux-x64</platforms>
                </folder>
                <folder>
                    <description>rdDownload</description>
                    <destination>${tomcatdir}/PredictGo/rdDownload</destination>
                    <name>rdDownload</name>
                    <platforms>linux-x64</platforms>
                </folder>
                <folder>
                    <description>R</description>
                    <destination>${tomcatdir}/PredictGo/R</destination>
                    <name>R</name>
                    <platforms>linux-x64</platforms>
                    <distributionFileList>
                        <distributionDirectory>
                            <origin>Web/R/scripts</origin>
                        </distributionDirectory>
                    </distributionFileList>
                </folder>
                <folder>
                    <description>rworkspace</description>
                    <destination>${tomcatdir}/PredictGo/R/workspace</destination>
                    <name>rworkspace</name>
                    <platforms>linux-x64</platforms>
                    <actionList>
                        <setInstallerVariable>
                            <name>project.overwritePolicy</name>
                            <value>onlyIfNewer</value>
                        </setInstallerVariable>
                    </actionList>
                </folder>
                <folder>
                    <description>_Reports</description>
                    <destination>${tomcatdir}/PredictGo/_Definitions</destination>
                    <name>_Reports</name>
                    <platforms>linux-x64</platforms>
                    <distributionFileList>
                        <distributionDirectory>
                            <origin>Web/_Definitions/_Reports</origin>
                            <onPackingFilterList>
                                <fileNameFilter>
                                    <logic>matches</logic>
                                    <pattern>goCustomizations.*</pattern>
                                    <patternType>regexp</patternType>
                                </fileNameFilter>
                            </onPackingFilterList>
                        </distributionDirectory>
                    </distributionFileList>
                </folder>
                <folder>
                    <description>_SupportFiles</description>
                    <destination>${installdir}/PredictGo/</destination>
                    <name>_SupportFiles</name>
                    <platforms>linux-x64</platforms>
                    <distributionFileList>
                        <distributionDirectory>
                            <origin>Web/_SupportFiles</origin>
                            <onPackingFilterList>
                                <fileNameFilter>
                                    <logic>matches</logic>
                                    <pattern>goCustomizations.*</pattern>
                                    <patternType>regexp</patternType>
                                </fileNameFilter>
                            </onPackingFilterList>
                        </distributionDirectory>
                    </distributionFileList>
                </folder>
            </folderList>
            <postInstallationActionList>
                <runProgram>
                    <abortOnError>0</abortOnError>
                    <program>${installdir}/apache-tomcat-8.5.24/bin/startup.sh</program>
                    <programArguments></programArguments>
                    <ruleList>
                        <fileExists>
                            <path>${installdir}/apache-tomcat-8.5.24/bin/startup.sh</path>
                        </fileExists>
                    </ruleList>
                </runProgram>
                <deleteFile path="${project.rollbackBackupDirectory}"/>
            </postInstallationActionList>
            <postUninstallationActionList>
                <deleteFile>
                    <path>${installdir}/apache-tomcat-8.5.24</path>
                    <ruleList>
                        <fileExists>
                            <path>${installdir}/apache-tomcat-8.5.24</path>
                        </fileExists>
                    </ruleList>
                </deleteFile>
                <deleteFile>
                    <path>${installdir}/java</path>
                    <ruleList>
                        <fileExists>
                            <path>${installdir}/java</path>
                        </fileExists>
                    </ruleList>
                </deleteFile>
            </postUninstallationActionList>
            <preUninstallationActionList>
                <runProgram>
                    <abortOnError>0</abortOnError>
                    <program>${installdir}/apache-tomcat-8.5.24/bin/shutdown.sh</program>
                    <programArguments></programArguments>
                    <showMessageOnError>0</showMessageOnError>
                    <ruleList>
                        <fileExists>
                            <path>${installdir}/apache-tomcat-8.5.24/bin/shutdown.sh</path>
                        </fileExists>
                    </ruleList>
                </runProgram>
            </preUninstallationActionList>
        </component>
    </componentList>
    <initializationActionList>
        <logMessage>
            <enableTimeStamp>0</enableTimeStamp>
            <text>Version:- ${product_version}
</text>
            <timeStampFormat></timeStampFormat>
        </logMessage>
        <setInstallerVariable name="installation_registry_path" persist="1" value="~">
            <ruleList>
                <platformTest negate="1" type="windows"/>
            </ruleList>
        </setInstallerVariable>
        <setInstallerVariable name="installation_registry_path" persist="1" value="/etc">
            <ruleList>
                <isTrue value="${installer_is_root_install}"/>
                <platformTest negate="1" type="windows"/>
            </ruleList>
        </setInstallerVariable>
        <createTimeStamp>
            <format>%Y%m%d%H%M%S</format>
            <variable>timestamp</variable>
        </createTimeStamp>
    </initializationActionList>
    <preInstallationActionList>
        <autodetectJava>
            <abortOnError>0</abortOnError>
            <promptUser>0</promptUser>
            <showMessageOnError>0</showMessageOnError>
            <validVersionList>
                <validVersion>
                    <bitness>64</bitness>
                    <maxVersion></maxVersion>
                    <minVersion>1.8</minVersion>
                    <requireJDK>0</requireJDK>
                    <vendor></vendor>
                </validVersion>
            </validVersionList>
        </autodetectJava>
        <dirName path="${java_executable}" variable="java_bin_dir"/>
        <dirName path="${java_bin_dir}" variable="java_home"/>

        <!-- <showInfo text="JAVA ${java_autodetected} PATH: ${java_executable}"/>-->
        <foreach>
            <values>version oldVersion installdir oldInstalldir tomcatdir oldtomcatdir</values>
            <variables>name variable</variables>
            <actionList>
                <setInstallerVariable name="${variable}" value=""/>
                <iniFileGet>
                    <file>${installation_registry_path}/${project.fullName}.ini</file>
                    <key>${name}</key>
                    <section>details</section>
                    <variable>${variable}</variable>
                    <ruleList>
                        <fileTest condition="exists" path="${installation_registry_path}/${project.fullName}.ini"/>
                    </ruleList>
                </iniFileGet>

                <!-- <showInfo text="name : ${name}"/>
                <showInfo text="variable : ${variable}"/>-->
            </actionList>
            <ruleList>
                <platformTest negate="1" type="windows"/>
            </ruleList>
        </foreach>

        <!-- Validate if the version bundled is valid for the update -->
        <throwError>
            <text>The existing installation of ${product_fullname} module is newer or same version. Aborting...</text>
            <ruleList>
                <compareVersions>
                    <logic>greater_or_equal</logic>
                    <version1>${oldVersion}</version1>
                    <version2>${project.version}</version2>
                </compareVersions>
            </ruleList>
        </throwError>

        <!-- default installdir value -->
        <setInstallerVariable>
            <name>default_installdir</name>
            <value>${platform_install_prefix}/Logi_Predict</value>
        </setInstallerVariable>

        <!-- old value for upgrade -->
        <setInstallerVariable>
            <name>default_installdir</name>
            <value>${oldInstalldir}</value>
            <ruleList>
                <fileExists path="${oldInstalldir}/uninstall.dat"/>
            </ruleList>
        </setInstallerVariable>
        <setInstallerVariable>
            <name>tomcatdir</name>
            <value>${oldtomcatdir}</value>
            <ruleList>
                <fileExists path="${oldInstalldir}/uninstall.dat"/>
            </ruleList>
        </setInstallerVariable>
        <componentSelection>
            <deselect>default</deselect>
            <select>upgrade</select>
            <ruleList>
                <fileExists path="${oldInstalldir}/uninstall.dat"/>
            </ruleList>
        </componentSelection>
        <actionGroup>
            <actionList>
                <!-- <showInfo>
                    <text>An existing installation has been detected in ${installdir}.</text>
                </showInfo>-->
                <showQuestion>
                    <default>yes</default>
                    <text>A version of the ${product_fullname} module is already installed in ${installdir}. Would you like to upgrade to current version ${project.version}?
Please note, clicking on Yes and then cancelling later will result in a corrupted Installer.
</text>
                    <title>PredictGo Module Upgrade</title>
                    <variable>shouldupgrade</variable>
                </showQuestion>
                <exit>
                    <exitCode>1</exitCode>
                    <ruleList>
                        <isFalse>
                            <value>${shouldupgrade}</value>
                        </isFalse>
                    </ruleList>
                </exit>
                <setInstallerVariable name="project.parameter(installdir).ask" value="0"/>
            </actionList>

            <!-- Assume an existing installation if ${installdir} directory exists -->
            <ruleList>
                <fileExists path="${oldInstalldir}/uninstall.dat"/>

                <!-- <fileTest condition="exists" path="${installdir}"/>-->
            </ruleList>
        </actionGroup>
    </preInstallationActionList>
    <readyToInstallActionList>
        <addDirectoriesToUninstaller>
            <addContents>1</addContents>
            <files>${installdir}/apache-tomcat-8.5.24;${installdir}/java;</files>
            <matchHiddenFiles>1</matchHiddenFiles>
        </addDirectoriesToUninstaller>
        <runProgram>
            <abortOnError>0</abortOnError>
            <program>${installdir}/apache-tomcat-8.5.24/bin/shutdown.sh</program>
            <programArguments></programArguments>
            <showMessageOnError>0</showMessageOnError>
            <ruleList>
                <fileExists>
                    <path>${installdir}/apache-tomcat-8.5.24/bin/shutdown.sh</path>
                </fileExists>
                <fileExists>
                    <path>${installdir}/uninstall.dat</path>
                </fileExists>
            </ruleList>
        </runProgram>
        <setInstallerVariable>
            <name>tomcatdir</name>
            <value>${installdir}/apache-tomcat-8.5.24/webapps</value>
            <ruleList>
                <compareValues>
                    <logic>equals</logic>
                    <value1>${tomcat}</value1>
                    <value2>installtomcat</value2>
                </compareValues>
            </ruleList>
        </setInstallerVariable>
    </readyToInstallActionList>
    <postInstallationActionList>
        <foreach>
            <values>version "${project.version}" installdir "${installdir}" tomcatdir "${tomcatdir}"</values>
            <variables>name variable</variables>
            <actionList>
                <iniFileSet>
                    <file>${installation_registry_path}/${project.fullName}.ini</file>
                    <key>${name}</key>
                    <section>details</section>
                    <value>${variable}</value>
                </iniFileSet>
            </actionList>
            <ruleList>
                <platformTest negate="1" type="windows"/>
            </ruleList>
        </foreach>
        <addFilesToUninstaller files="${installation_registry_path}/${project.fullName}.ini"/>
    </postInstallationActionList>
    <disableSplashScreen>1</disableSplashScreen>
    <enableRollback>1</enableRollback>
    <enableTimestamp>1</enableTimestamp>
    <height>420</height>
    <installationLogFile>${installdir}/${project.shortName}-${product_version}-installLog.log</installationLogFile>
    <licenseFileEncoding>utf-8</licenseFileEncoding>
    <readmeFileEncoding>utf-8</readmeFileEncoding>
    <rollbackBackupDirectory>${installdir}/backups</rollbackBackupDirectory>
    <saveRelativePaths>1</saveRelativePaths>
    <showFileUnpackingProgress>0</showFileUnpackingProgress>
    <uninstallationLogFile>${system_temp_directory}/${project.shortName}-uninstallation.log</uninstallationLogFile>
    <vendor>LogiAnalytics</vendor>
    <width>600</width>
    <windows64bitMode>1</windows64bitMode>
    <customLanguageFileList>
        <language>
            <code>en</code>
            <file>supportfiles/PredictGo_en.lng</file>
        </language>
    </customLanguageFileList>
    <parameterList>
        <licenseParameter>
            <name>logi_license</name>
            <title>Logi Analytics License Agreement</title>
            <description>Please read the following License Agreement. You must accept the terms of this agreement before continuing with the installation.</description>
            <explanation></explanation>
            <file>supportfiles/License.txt</file>
            <htmlFile></htmlFile>
            <insertAfter>welcome</insertAfter>
            <wrapText>1</wrapText>
            <licenseFileList>
                <licenseFile>
                    <code>en</code>
                    <file></file>
                </licenseFile>
            </licenseFileList>
        </licenseParameter>
        <choiceParameter>
            <name>tomcat</name>
            <title>Tomcat web server configuration.</title>
            <description></description>
            <explanation>Logi Predict requires a web server to run.</explanation>
            <value></value>
            <default>localtomcat</default>
            <allowEmptyValue>1</allowEmptyValue>
            <displayType>radiobuttons</displayType>
            <insertAfter>logi_license</insertAfter>
            <ordering>default</ordering>
            <width>40</width>
            <optionList>
                <option>
                    <description></description>
                    <image></image>
                    <text>Yes, install the bundled Tomcat.</text>
                    <value>installtomcat</value>
                </option>
                <option>
                    <description></description>
                    <image></image>
                    <text>Use my existing Tomcat.</text>
                    <value>localtomcat</value>
                </option>
            </optionList>
            <ruleList>
                <isTrue value="${project.component(default).selected}"/>
            </ruleList>
        </choiceParameter>
        <directoryParameter>
            <name>tomcatdir</name>
            <title>location of the local Tomcat on machine.</title>
            <description>tomcatdir</description>
            <explanation>Please provide the location of Tomcat "webapps" folder on machine for use of ${product_fullname}.</explanation>
            <value></value>
            <default></default>
            <allowEmptyValue>0</allowEmptyValue>
            <insertAfter>tomcat</insertAfter>
            <mustBeWritable>1</mustBeWritable>
            <mustExist>1</mustExist>
            <width>40</width>
            <ruleList>
                <compareValues>
                    <logic>equals</logic>
                    <value1>${tomcat}</value1>
                    <value2>localtomcat</value2>
                </compareValues>
                <isTrue value="${project.component(default).selected}"/>
            </ruleList>
            <validationActionList>
                <throwError>
                    <text>This directory is not a tomcat direcotry. please install tomcat or select install tomcat in the options.</text>
                    <ruleList>
                        <fileTest>
                            <condition>not_exists</condition>
                            <path>${tomcatdir}/../bin/catalina.sh</path>
                        </fileTest>
                    </ruleList>
                </throwError>
                <throwError>
                    <text>Permission denied to write in to Directory :- ${tomcatdir}. Please give permissions to tomcat directory and try again.</text>
                    <ruleList>
                        <fileTest>
                            <condition>not_writable</condition>
                            <path>${tomcatdir}</path>
                        </fileTest>
                    </ruleList>
                </throwError>
            </validationActionList>
        </directoryParameter>
        <stringParameter>
            <name>port</name>
            <title>Tomcat web server configuration.</title>
            <description>port :                         </description>
            <explanation></explanation>
            <value></value>
            <default>8080</default>
            <allowEmptyValue>0</allowEmptyValue>
            <insertAfter>tomcat</insertAfter>
            <width>7</width>
            <ruleList>
                <compareValues>
                    <logic>equals</logic>
                    <value1>${tomcat}</value1>
                    <value2>installtomcat</value2>
                </compareValues>
                <isTrue value="${project.component(default).selected}"/>
            </ruleList>
            <validationActionList>
                <throwError>
                    <text>port : ${port} in use.</text>
                    <ruleList>
                        <portTest>
                            <condition>cannot_bind</condition>
                            <port>${port}</port>
                        </portTest>
                    </ruleList>
                </throwError>
            </validationActionList>
        </stringParameter>
        <choiceParameter>
            <name>java_setup_type</name>
            <title>Java Runtime Environment.</title>
            <description></description>
            <explanation>The ${product_fullname} being installed requires version 1.8 of the Java runtime environment. We have detected that you already have Java 1.8 installed on this machine.

You can choose to have ${product_fullname} use your existing installation of Java or have it install a bundled version of Java specifically for use with ${product_fullname} only.

Logi Analytics recommends that you install the bundled version of the Java 1.8. runtime. If this option is chosen, you will be presented with a dialog showing a click through license from Oracle Corporation. </explanation>
            <value></value>
            <default>bundlejre</default>
            <allowEmptyValue>1</allowEmptyValue>
            <displayType>radiobuttons</displayType>
            <insertBefore>java_license</insertBefore>
            <ordering>default</ordering>
            <width>40</width>
            <optionList>
                <option>
                    <description></description>
                    <image></image>
                    <text>Install bundled Java 1.8 now, for use only with the ${product_fullname}.
 </text>
                    <value>bundlejre</value>
                </option>
                <option>
                    <description>Your existing JRE will be used with ${product_fullname}.  Your existing JRE appears to be installed at &lt;JAVA_HOME&gt; : ${java_home}".</description>
                    <image></image>
                    <text>Use my existing Java 1.8 JRE for ${product_fullname}. JRE1.8.0_41 or later is required.</text>
                    <value>defaultxyz</value>
                </option>
            </optionList>
            <postShowPageActionList>
                <if>
                    <actionList>
                        <setInstallerVariable>
                            <name>bundle_java</name>
                            <value>0</value>
                            <ruleList>
                                <compareValues>
                                    <logic>equals</logic>
                                    <value1>${java_setup_type}</value1>
                                    <value2>defaultxyz</value2>
                                </compareValues>
                            </ruleList>
                        </setInstallerVariable>
                        <setInstallerVariable>
                            <name>bundle_java</name>
                            <value>1</value>
                            <ruleList>
                                <compareValues>
                                    <logic>equals</logic>
                                    <value1>${java_setup_type}</value1>
                                    <value2>bundlejre</value2>
                                </compareValues>
                            </ruleList>
                        </setInstallerVariable>
                    </actionList>
                </if>
            </postShowPageActionList>
            <ruleList>
                <isTrue value="${java_autodetected}"/>
                <isTrue value="${project.component(default).selected}"/>
                <compareValues>
                    <logic>equals</logic>
                    <value1>${tomcat}</value1>
                    <value2>installtomcat</value2>
                </compareValues>
            </ruleList>
        </choiceParameter>
        <choiceParameter>
            <name>install_java</name>
            <title>Install Java JRE</title>
            <description></description>
            <explanation>The ${product_fullname} being installed requires version 1.8 of the Java runtime environment.  Java 1.8 does not appear to be installed on this machine.

 Would you like the installer to continue and install it's bundled Java 8 for use only with ${product_fullname}?

Logi Analytics recommends that you install the bundled version of the Java 1.8. runtime. If this option is chosen, you will be presented with a dialog showing a click through license from Oracle Corporation which you must accept.
 </explanation>
            <value></value>
            <default>bundlejava</default>
            <allowEmptyValue>1</allowEmptyValue>
            <displayType>radiobuttons</displayType>
            <insertBefore>java_license</insertBefore>
            <ordering>default</ordering>
            <width>40</width>
            <optionList>
                <option>
                    <description></description>
                    <image></image>
                    <text>Yes, install bundled Java 1.8 now, for use only with the ${product_fullname}. </text>
                    <value>bundlejava</value>
                </option>
                <option>
                    <description></description>
                    <image></image>
                    <text>No, I'll download and Install Java 8 myself at later time.</text>
                    <value>download</value>
                </option>
            </optionList>
            <postShowPageActionList>
                <if>
                    <actionList>
                        <setInstallerVariable>
                            <name>bundle_java</name>
                            <value>1</value>
                            <ruleList>
                                <compareValues>
                                    <logic>equals</logic>
                                    <value1>${install_java}</value1>
                                    <value2>bundlejava</value2>
                                </compareValues>
                            </ruleList>
                        </setInstallerVariable>
                    </actionList>
                </if>
            </postShowPageActionList>
            <ruleList>
                <isFalse value="${java_autodetected}"/>
                <isFalse value="${java_setup_page}"/>
                <isTrue value="${project.component(default).selected}"/>
            </ruleList>
            <validationActionList>
                <throwError>
                    <text>Java JRE 8 is required to proceed with the installation. Please install it and relaunch this installer. For now, please select cancel to abort the installation.</text>
                    <ruleList>
                        <compareValues>
                            <logic>equals</logic>
                            <value1>${install_java}</value1>
                            <value2>download</value2>
                        </compareValues>
                    </ruleList>
                </throwError>
            </validationActionList>
        </choiceParameter>
        <licenseParameter>
            <name>java_license</name>
            <title>Java License Agreement</title>
            <description>Please read the following License Agreement. You must accept the terms of this agreement before continuing with the installation.</description>
            <explanation></explanation>
            <file>supportfiles/Licensejava.txt</file>
            <htmlFile></htmlFile>
            <insertBefore>installdir</insertBefore>
            <wrapText>1</wrapText>
            <ruleList>
                <isTrue>
                    <value>${bundle_java}</value>
                </isTrue>
            </ruleList>
        </licenseParameter>
        <directoryParameter>
            <name>installdir</name>
            <description>Installer.Parameter.installdir.description</description>
            <explanation>Installer.Parameter.installdir.explanation</explanation>
            <value></value>
            <default>${default_installdir}</default>
            <allowEmptyValue>0</allowEmptyValue>
            <cliOptionName>prefix</cliOptionName>
            <insertBefore>readytoinstall</insertBefore>
            <mustBeWritable>1</mustBeWritable>
            <mustExist>0</mustExist>
            <width>40</width>
        </directoryParameter>
    </parameterList>
</project>

